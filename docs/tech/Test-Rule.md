# テストケース作成ルール

本プロジェクトにおけるテストケース作成の一般的なガイドラインです。品質維持のため、以下の原則に従ってテストを記述してください。

## 1. テストの構成 (AAAパターン)
テスト内は、原則として以下の3つのセクションに分けて記述してください。

1. **Arrange (準備)**：コンポーネントの生成や状態、モックの設定。
2. **Act (実行)**：テスト対象のメソッド呼び出しやユーザー操作のシミュレーション。
3. **Assert (検証)**：結果が期待通りであるかの確認。

```typescript
// 例 (Jasmine)
it('should calculate total correctly', () => {
  // Arrange
  const service = new CalculatorService();
  
  // Act
  const result = service.add(1, 2);
  
  // Assert
  expect(result).toBe(3);
});
```

## 2. カバレッジの取得
本プロジェクトでは、コード網羅率（カバレッジ）を測定し、テストの十分性を確認します。

- **使用ツール**：Karma / Istanbul (Angular CLI 標準)
- **目標値**：[品質方針](Quality-Policy.md) を参照
- **実行方法**：
  ```bash
  ng test --no-watch --code-coverage
  ```
  実行後、`coverage/` ディレクトリにレポートが生成されます。

## 3. 注意事項
- **独立性**：各テストケースは独立しており、実行順序に依存しないようにしてください。
- **カバレッジ**：正常系だけでなく、異常系（エラーハンドリング、境界値）も網羅するようにしてください。
- **可読性**：1つのテスト（`it` ブロック）で検証する内容は、原則として1つの目的に絞ってください。
- **非同期テスト**：Angular の `waitForAsync` や `fakeAsync`/`tick` を活用し、非同期処理を正確にテストしてください。
