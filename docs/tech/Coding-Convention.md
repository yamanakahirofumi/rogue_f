# コーディング規約 (Coding Convention)

本プロジェクトにおける TypeScript および Angular コードの記述基準を定義します。

## 1. 基本規則

### 1.1 型定義の徹底
- `any` の使用は極力避け、適切なインターフェースや型を定義してください。
- 関数の引数と戻り値には必ず型を指定してください。
- プロジェクト全体で共有されるデータ構造や、外部APIのレスポンス等の型定義は、`src/@types/` 配下に型定義ファイル（`.d.ts`）として作成することを心がけてください。これにより、ドメイン層やコンポーネント間での型の整合性を保ちます。

### 1.2 不変性の維持
- 変数の宣言には原則として `const` を使用し、再代入が必要な場合のみ `let` を使用してください。
- 配列やオブジェクトの変更にはスプレッド構文等を活用し、非破壊的な操作を心がけてください。

### 1.3 名前付け規則
- クラス名、インターフェース名は `UpperCamelCase`（例：`UserComponent`）を使用します。
- メソッド名、変数名、プロパティ名は `lowerCamelCase`（例：`getUserData`）を使用します。
- 定数は `UPPER_SNAKE_CASE`（例：`MAX_RETRY_COUNT`）を使用します。

## 2. Angular 固有のプラクティス

### 2.1 コンポーネント設計
- コンポーネントのテンプレートが肥大化しないよう、責務に応じて適切に分割してください。
- スタイルはコンポーネント固有の CSS ファイルに記述し、グローバルなスタイルへの依存は最小限にしてください。

### 2.2 サービスの利用
- コンポーネントにビジネスロジックを詰め込まず、共通ロジックやデータ取得はサービス（Service）に切り出してください。

### 2.3 RxJS の扱い
- `Observable` 変数名には末尾に `$` を付ける慣習（例：`user$`）を推奨します。
- メモリリークを防ぐため、`Subscription` は適切に解除（`unsubscribe`）するか、`async` パイプを活用してください。

## 3. その他のプラクティス

### 3.1 Null の取り扱い
- `null` や `undefined` の可能性がある場合は、オプショナルチェイニング（`?.`）や Null 合体演算子（`??`）を活用して安全に処理してください。

### 3.2 フォーマット
- Prettier 等のフォーマッタを利用し、プロジェクト内で統一されたコードスタイルを維持してください。


## 4. 責務分離（Angular と Pure TypeScript）

本プロジェクトでは、Angular は SPA としての範囲（UI 描画、イベント管理、DI/サービス連携）に限定し、ドメインロジックは純粋な TypeScript で記述します。これをコーディング規約として明記します。

- ドメインコードの原則
  - Angular 由来の import（`@angular/*`）を含めない
  - ブラウザ固有 API に直接依存しない（必要に応じてポート/アダプタ層で吸収）
  - 副作用の少ないピュアな関数/クラス設計を優先する
  - 物理配置は `src/app/fields/d/` 等のフレームワーク非依存ディレクトリを推奨
- アプリケーション/プレゼンテーション層の原則
  - Component は UI とイベントの結線に専念し、業務ルールは呼び出すだけに留める
  - Service は API 通信やデータ取得、ドメイン呼び出しの調停を担うが、ドメイン規則そのものは持たない
- 依存方向（必須ルール）
  - Component/Service → ドメイン（許可）
  - ドメイン → Component/Service（禁止）

これにより、テスト容易性（Jasmine による純粋 TS の高速ユニットテスト）と、フレームワーク変更耐性を高めます。
